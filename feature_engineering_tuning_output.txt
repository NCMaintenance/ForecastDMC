Warning: lgb.LightGBMWarning not found, specific LightGBM warnings may not be suppressed.
Script started: New Feature Engineering, Hyperparameter Tuning (Iter 2), and MAE Re-evaluation
Data loaded. Shape: (7936, 57)
Starting Advanced Feature Engineering...
Data shape after new features: (7936, 62)
New features created: Hour_DayOfWeek, Hospital_Code_Hour, Capacity_Hour_Interaction (if applicable), DaysToNextHoliday, DaysFromLastHoliday

Processing Hospital: Cork University Hospital, Dev records: 2627, Test records: 19
  Tuning for Target: ED Beds with new features
    GridSearchCV for ED Beds (new features) with 2 splits, test_size=21...
    Best params for ED Beds (new features): {'colsample_bytree': 0.8, 'force_col_wise': True, 'learning_rate': 0.05, 'max_depth': 7, 'n_estimators': 400, 'num_leaves': 31, 'random_state': 42, 'reg_alpha': 0.1, 'reg_lambda': 0.1, 'subsample': 0.8, 'verbose': -1}
    Cork University Hospital - ED Beds - Tuned Test MAE (new features): 15.33
  Tuning for Target: Trolleys with new features
    GridSearchCV for Trolleys (new features) with 2 splits, test_size=21...
    Best params for Trolleys (new features): {'colsample_bytree': 0.8, 'force_col_wise': True, 'learning_rate': 0.05, 'max_depth': 7, 'n_estimators': 400, 'num_leaves': 31, 'random_state': 42, 'reg_alpha': 0.1, 'reg_lambda': 0.1, 'subsample': 0.8, 'verbose': -1}
    Cork University Hospital - Trolleys - Tuned Test MAE (new features): 3.94
  Tuning for Target: Capacity with new features
    GridSearchCV for Capacity (new features) with 2 splits, test_size=21...
    Best params for Capacity (new features): {'colsample_bytree': 0.8, 'force_col_wise': True, 'learning_rate': 0.05, 'max_depth': 7, 'n_estimators': 400, 'num_leaves': 50, 'random_state': 42, 'reg_alpha': 0.1, 'reg_lambda': 0.1, 'subsample': 0.8, 'verbose': -1}
    Cork University Hospital - Capacity - Tuned Test MAE (new features): 3.08

Processing Hospital: Mercy University Hospital, Dev records: 2625, Test records: 19
  Tuning for Target: ED Beds with new features
    GridSearchCV for ED Beds (new features) with 2 splits, test_size=21...
    Best params for ED Beds (new features): {'colsample_bytree': 0.8, 'force_col_wise': True, 'learning_rate': 0.05, 'max_depth': 7, 'n_estimators': 400, 'num_leaves': 50, 'random_state': 42, 'reg_alpha': 0.1, 'reg_lambda': 0.1, 'subsample': 0.8, 'verbose': -1}
    Mercy University Hospital - ED Beds - Tuned Test MAE (new features): 6.28
  Tuning for Target: Trolleys with new features
    GridSearchCV for Trolleys (new features) with 2 splits, test_size=21...
    Best params for Trolleys (new features): {'colsample_bytree': 0.8, 'force_col_wise': True, 'learning_rate': 0.05, 'max_depth': 7, 'n_estimators': 400, 'num_leaves': 50, 'random_state': 42, 'reg_alpha': 0.1, 'reg_lambda': 0.1, 'subsample': 0.8, 'verbose': -1}
    Mercy University Hospital - Trolleys - Tuned Test MAE (new features): 1.61
  Tuning for Target: Capacity with new features
    GridSearchCV for Capacity (new features) with 2 splits, test_size=21...
    Best params for Capacity (new features): {'colsample_bytree': 0.8, 'force_col_wise': True, 'learning_rate': 0.05, 'max_depth': 5, 'n_estimators': 400, 'num_leaves': 31, 'random_state': 42, 'reg_alpha': 0.1, 'reg_lambda': 0.1, 'subsample': 0.8, 'verbose': -1}
    Mercy University Hospital - Capacity - Tuned Test MAE (new features): 1.83

Processing Hospital: UH Kerry, Dev records: 2627, Test records: 19
  Tuning for Target: ED Beds with new features
    GridSearchCV for ED Beds (new features) with 2 splits, test_size=21...
    Best params for ED Beds (new features): {'colsample_bytree': 0.8, 'force_col_wise': True, 'learning_rate': 0.05, 'max_depth': 5, 'n_estimators': 400, 'num_leaves': 31, 'random_state': 42, 'reg_alpha': 0.1, 'reg_lambda': 0.1, 'subsample': 0.8, 'verbose': -1}
    UH Kerry - ED Beds - Tuned Test MAE (new features): 7.71
  Tuning for Target: Trolleys with new features
    GridSearchCV for Trolleys (new features) with 2 splits, test_size=21...
    Best params for Trolleys (new features): {'colsample_bytree': 0.8, 'force_col_wise': True, 'learning_rate': 0.05, 'max_depth': 7, 'n_estimators': 400, 'num_leaves': 50, 'random_state': 42, 'reg_alpha': 0.1, 'reg_lambda': 0.1, 'subsample': 0.8, 'verbose': -1}
    UH Kerry - Trolleys - Tuned Test MAE (new features): 1.95
  Tuning for Target: Capacity with new features
    GridSearchCV for Capacity (new features) with 2 splits, test_size=21...
    Best params for Capacity (new features): {'colsample_bytree': 0.8, 'force_col_wise': True, 'learning_rate': 0.05, 'max_depth': 7, 'n_estimators': 400, 'num_leaves': 50, 'random_state': 42, 'reg_alpha': 0.1, 'reg_lambda': 0.1, 'subsample': 0.8, 'verbose': -1}
    UH Kerry - Capacity - Tuned Test MAE (new features): 0.67

Tuned hyperparameters (iter 2) saved to tuned_hyperparameters_iter2.json
Average MAE after tuning (iter 2 with new features): 4.7104
Script finished: New Feature Engineering, Hyperparameter Tuning (Iter 2), and MAE Re-evaluation
